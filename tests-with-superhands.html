<html class="a-fullscreen">

<head>
    <title>Oculus</title>
    <meta aframe-injected="" name="viewport"
        content="width=device-width,initial-scale=1,maximum-scale=1,shrink-to-fit=no,user-scalable=no,minimal-ui,viewport-fit=cover">
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <link href="assets/css/main.css" rel="stylesheet">
    <!-- the aframe standard library -->
    <script src="https://aframe.io/releases/0.9.2/aframe.js"></script>

    <!-- adding physics -->
    <script src="lib/aframe/aframe-physics-system.min.js"></script>
    <script src="lib/aframe/aframe-physics-extras.min.js"></script>
    <script src="lib/aframe/aframe-event-set-component.min.js"></script>



    <!-- superhands code -->
    <script src="https://cdn.rawgit.com/donmccurdy/aframe-extras/v4.1.2/dist/aframe-extras.min.js"></script>
    <script src="https://unpkg.com/super-hands@3.0.0/dist/super-hands.min.js"></script>
</head>

<body>
    <a-scene physics>
        <!-- common assets -->
        <a-assets>
            <!--
            the oculus controller (hands-left, hands-right) MIXIN
            enables interacting between controler an objects

            using 'superhands'
            using a 'sphere-collider' for superhands  
        
            hover & drag-drop won't have any obvious effect without some additional event handlers or components.

            colliderEvent: collision                -> makes objects grabbable
            colliderEvent: raycaster-intersection:  -> ???
            -->
            <a-mixin id="interaction" sphere-collider="objects: #box, #sphere, #object" physics-collider phase-shift
                collision-filter laser-controls line raycaster="
                showLine: true; 
                objects: .cube" collision-filter="collisionForces: false" static-body="
                shape: sphere; 
                sphereRadius: 0.001" super-hands="

                colliderEvent: collisions;
                colliderEventProperty: els;
                colliderEndEvent: collisions;
                colliderEndEventProperty: clearedEls;

                grabStartButtons: gripdown, mousedown;
                grabEndButtons: gripup, mouseup;

                startButtons: triggerdown; 
                endButtons: triggerup;">
            </a-mixin>
        </a-assets>

        <!-- 
        the oculus controller (hands-left, hands-right)

        using the interaction mixin (assets)
        -->
        <a-entity mixin="interaction" hand-controls="left">
        </a-entity>
        <a-entity mixin="interaction" hand-controls="right">
        </a-entity>
        <!--  -->

        <!-- 
        2 simple boxes
        the id's are registered in the sphere-sollider object list
        this enabled grabbing and scaling 
        -->
        <a-box id="box" color="orange" width="0.5" height="1" depth="0.5" position="0.3 1.5 -2.5" rotation="0 0 0"
            hoverable grabbable stretchable draggable droppable dynamic-body></a-box>

        <a-sphere id="sphere" color="orange" radius="0.5" position="-0.3 0.8 -2" rotation="0 0 0" hoverable grabbable
            stretchable draggable droppable dynamic-body></a-sphere>

        <!--
            a ground box to avoid deep tumbles
        -->
        <a-box id="ground" color="maroon" width="5" height="0.1" depth="10" position="0 -0.05 -5" static-body></a-box>

        <!-- 
        an external obj-file
        it can be grabbed by dynamic-body="shape: sphere; mass: 2; sphereRadius: 0.5; halfExtents: 0.5 0.5 0.5;"
        @see https://github.com/donmccurdy/aframe-physics-system
        -->
        <a-obj-model id="object" scale="1 1 1" position="0.1 0.8 -1.2" hoverable grabbable stretchable draggable
            droppable sphere-collider obj-model="obj: assets/models/room.obj; mtl: assets/models/room.mtl"
            dynamic-body="shape: sphere; mass: 2; sphereRadius: 0.5; halfExtents: 0.5 0.5 0.5;">
        </a-obj-model>

        <a-text id="text" position="-1 2 -2"
            value="Sedative posuere consectetur est at lobortis. Cras justo odio, dapibus ac facilisis in, egestas eget quam. Morbi leo risus, porta ac consectetur ac, vestibulum at eros. Aenean eu leo quam. Pellentesque ornare sem lacinia quam venenatis vestibulum."
            color="rgb(220,220,220)" width="2" height="1" font="https://cdn.aframe.io/fonts/Exo2SemiBold.fnt"></a-text>

        <!-- <a-entity log="message: Hello, Metaverse!"></a-entity> -->

        <a-light type="spot" position="-3 4 4" color="red" lookat="object"></a-light>
        <a-light type="spot" position="-1 -4 4" color="green" lookat="object"></a-light>
        <a-light type="spot" position="-2 4 4" color="blue" lookat="object"></a-light>
    </a-scene>
    <script>
        (function () {
            'use strict';
            // - - - - - - - - - -
            window.onload = function () {
                // - - - - -
                // DECLARATION
                let inworld = {};

                /** INVENTING AN INWORLD OBJECT
                 * @desc the inworld objet is a container for inworld function,
                 *       i.e. a log() that can be seen in a textframe
                 * @version 1.0.0
                 * @author Michael
                 *
                 * An inworld log function
                 * @param {string} message any text string to set into a inworls textframe
                 * @return none
                 */
                inworld.log = function (message) {
                    let
                        _message = message || undefined,
                        _text = document.querySelector('#text') || undefined;

                    if (_message === undefined) return false;
                    if (_text === undefined) return false;

                    _text.setAttribute('value', _message);

                };

                // REGISTER AFRAME COMPONENTS
                // AFRAME.registerComponent('log', {
                //     schema: {
                //         message: {
                //             type: 'string',
                //             default: 'Hello, World!'
                //         }
                //     },
                //     init: function () {
                //         console.log(this.data.message);
                //     }
                // });

                // AFRAME.registerComponent('box', {
                //     // the object properties
                //     // example is a box
                //     // the schema property 'width' can be called as 'this.data.width'
                //     schema: {
                //         width: {
                //             type: 'number',
                //             default: 1
                //         },
                //         height: {
                //             type: 'number',
                //             default: 1
                //         },
                //         depth: {
                //             type: 'number',
                //             default: 1
                //         },
                //         color: {
                //             type: 'color',
                //             default: 'steelblue'
                //         }
                //     },
                //     // the object behaviour after compiling 
                //     init: function () {
                //         var data = this.data; // references the schema properties
                //         var el = this.el; //     references the a-frame-entity

                //         console.log(el);
                //         console.log(data);

                //         // Create geometry.
                //         this.geometry = new THREE.BoxBufferGeometry(data.width, data.height, data.depth);

                //         // Create material.
                //         this.material = new THREE.MeshStandardMaterial({
                //             color: data.color
                //         });

                //         // Create mesh.
                //         this.mesh = new THREE.Mesh(this.geometry, this.material);

                //         // Set mesh on entity.
                //         el.setObject3D('mesh', this.mesh);
                //     },
                //     update: function () {
                //         var data = this.data;
                //         var el = this.el;

                //         // If `oldData` is empty, then this means we're in the initialization process.
                //         // No need to update.
                //         if (Object.keys(oldData).length === 0) {
                //             return;
                //         }

                //         // Geometry-related properties changed. Update the geometry.
                //         if (data.width !== oldData.width ||
                //             data.height !== oldData.height ||
                //             data.depth !== oldData.depth) {
                //             el.getObject3D('mesh').geometry = new THREE.BoxBufferGeometry(data.width, data
                //                 .height,
                //                 data.depth);
                //         }

                //         // Material-related properties changed. Update the material.
                //         if (data.color !== oldData.color) {
                //             el.getObject3D('mesh').material.color = new THREE.Color(data.color);
                //         }

                //     },
                //     remove: function () {
                //         this.el.removeObject3D('mesh');
                //     }
                // })



                // let box = document.querySelector('#box').addEventListener('collide', function (event) {
                //     text.setAttribute('value', event.target);
                // })
                // - - - - -
            };
            // - - - - - - - - - -
        })();
    </script>
</body>

</html>